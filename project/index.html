<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>위카랜트카</title>

    <script src="./js/jquery-1.12.4.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="./js/swiper.min.js"></script>
    <script src="./js/commons.js"></script>
    <script src="./js/index.js"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha512-DxV+EoADOkOygM4IR9yXP8Sb2qwgidEmeqAEmDKIOfPRQZOWbXCzLC6vjbZyy0vPisbH2SyW27+ddLVCN+OMzQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="./css/swiper.css" />
    <link rel="stylesheet" href="./css/index.css" />
</head>

<body>
    <header id="header">
        <div class="top">
            <nav class="topmenu">
                <button type="button" class="btn btn-bookmark">즐겨찾기 추가</button>
                <a href="">로그인/회원가입</a>
                <a href="">예약확인</a>
            </nav>
        </div>
        <div class="wrap">
            <div class="logo">
                <a href="/">WE<span class="lo2">C</span>AR</a>
            </div>
            <nav class="menu">
                <a href="">단기 렌트</a>
                <a href="">장기 렌트</a>
                <a href="">이벤트</a>
                <a href="">고객센터</a>
            </nav>
        </div>
    </header>
    <div id="fixedbg"></div>
    <section id="main01">
        <div class="txtBox">
            <div id="ani">
                <h1>WECAR IS  
                <span class="typing-txt"></span> 
                <span class="typing"></span> 
                </h1>
                <h5 class="typing-sm"></h5>
            </div>
            <div class="car" id="car3d"></div>
            <script type="importmap">
                {
                    "imports": {
                        "three": "./build/three.module.js",
                        "three/addons/": "./jsm/"
                    }
                }
            </script>

            <script type="module">

                import * as THREE from 'three';

                import Stats from 'three/addons/libs/stats.module.js';

                import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
                import { FBXLoader } from 'three/addons/loaders/FBXLoader.js';
                import { GUI } from 'three/addons/libs/lil-gui.module.min.js';

                const manager = new THREE.LoadingManager();

                let camera, scene, renderer, stats, object, loader, guiMorphsFolder;
                let mixer;

                const clock = new THREE.Clock();

                const params = {
                    asset: 'Samba Dancing'
                };

                const assets = [
                    'Samba Dancing',
                    'morph_test',
                    'monkey',
                    'monkey_embedded_texture'
                ];


                init();

                function init() {

                    const container = document.createElement( 'div' );
                    document.body.appendChild( container );

                    camera = new THREE.PerspectiveCamera( 45, window.innerWidth / window.innerHeight, 1, 2000 );
                    camera.position.set( 100, 200, 300 );

                    scene = new THREE.Scene();
                    scene.background = new THREE.Color( 0xa0a0a0 );
                    scene.fog = new THREE.Fog( 0xa0a0a0, 200, 1000 );

                    const hemiLight = new THREE.HemisphereLight( 0xffffff, 0x444444, 5 );
                    hemiLight.position.set( 0, 200, 0 );
                    scene.add( hemiLight );

                    const dirLight = new THREE.DirectionalLight( 0xffffff, 5 );
                    dirLight.position.set( 0, 200, 100 );
                    dirLight.castShadow = true;
                    dirLight.shadow.camera.top = 180;
                    dirLight.shadow.camera.bottom = - 100;
                    dirLight.shadow.camera.left = - 120;
                    dirLight.shadow.camera.right = 120;
                    scene.add( dirLight );

                    // scene.add( new THREE.CameraHelper( dirLight.shadow.camera ) );

                    // ground
                    const mesh = new THREE.Mesh( new THREE.PlaneGeometry( 2000, 2000 ), new THREE.MeshPhongMaterial( { color: 0x999999, depthWrite: false } ) );
                    mesh.rotation.x = - Math.PI / 2;
                    mesh.receiveShadow = true;
                    scene.add( mesh );

                    const grid = new THREE.GridHelper( 2000, 20, 0x000000, 0x000000 );
                    grid.material.opacity = 0.2;
                    grid.material.transparent = true;
                    scene.add( grid );
                
                    loader = new FBXLoader( manager );
                    loadAsset( params.asset );

                    renderer = new THREE.WebGLRenderer( { antialias: true } );
                    renderer.setPixelRatio( window.devicePixelRatio );
                    renderer.setSize( window.innerWidth, window.innerHeight );
                    renderer.setAnimationLoop( animate );
                    renderer.shadowMap.enabled = true;
                    container.appendChild( renderer.domElement );

                    const controls = new OrbitControls( camera, renderer.domElement );
                    controls.target.set( 0, 100, 0 );
                    controls.update();

                    window.addEventListener( 'resize', onWindowResize );

                    // stats
                    stats = new Stats();
                    container.appendChild( stats.dom );

                    const gui = new GUI();
                    gui.add( params, 'asset', assets ).onChange( function ( value ) {

                        loadAsset( value );

                    } );

                    guiMorphsFolder = gui.addFolder( 'Morphs' ).hide();

                }

                function loadAsset( asset ) {

                    loader.load( 'models/fbx/' + asset + '.fbx', function ( group ) {

                        if ( object ) {

                            object.traverse( function ( child ) {

                                if ( child.isSkinnedMesh ) {

                                    child.skeleton.dispose();

                                }

                                if ( child.material ) {

                                    const materials = Array.isArray( child.material ) ? child.material : [ child.material ];
                                    materials.forEach( material => {

                                        if ( material.map ) material.map.dispose();
                                        material.dispose();
                
                                    } );
                
                                }
                
                                if ( child.geometry ) child.geometry.dispose();

                            } );

                            scene.remove( object );

                        }

                        //

                        object = group;

                        if ( object.animations && object.animations.length ) {

                            mixer = new THREE.AnimationMixer( object );

                            const action = mixer.clipAction( object.animations[ 0 ] );
                            action.play();

                        } else {

                            mixer = null;

                        }

                        guiMorphsFolder.children.forEach( ( child ) => child.destroy() );
                        guiMorphsFolder.hide();

                        object.traverse( function ( child ) {

                            if ( child.isMesh ) {

                                child.castShadow = true;
                                child.receiveShadow = true;

                                if ( child.morphTargetDictionary ) {

                                    guiMorphsFolder.show();
                                    const meshFolder = guiMorphsFolder.addFolder( child.name || child.uuid );
                                    Object.keys( child.morphTargetDictionary ).forEach( ( key ) => {
                
                                        meshFolder.add( child.morphTargetInfluences, child.morphTargetDictionary[ key ], 0, 1, 0.01 );
                
                                    } );
                
                                }

                            }

                        } );

                        scene.add( object );

                    } );

                }

                function onWindowResize() {

                    camera.aspect = window.innerWidth / window.innerHeight;
                    camera.updateProjectionMatrix();

                    renderer.setSize( window.innerWidth, window.innerHeight );

                }

                //

                function animate() {

                    const delta = clock.getDelta();

                    if ( mixer ) mixer.update( delta );

                    renderer.render( scene, camera );

                    stats.update();

                }

            </script>
        </div>
        <div class="main_slider swiper-container">
			<div class="swiper-wrapper">
				<div class="swiper-slide slide01">
					<div class="txtBox">
                        <h2>여행의 시작, <br/>위카렌트카</h2>
                        <p>전국 어디서든 실시간으로 예약하고 바로 출발하세요!</p>
                    </div>
				</div>
				<div class="swiper-slide slide02">
					<div class="txtBox">
                        <h2>실시간 렌트 예약은,<br/>WE CAR</h2>
                        <p>온라인으로 10초만에 간편하게 예약하세요.</p>
                    </div>
				</div>
                <div class="swiper-slide slide03">
					<div class="txtBox">
                        <h2>가입만 해도, <br/>할인 쿠폰 즉시 지급!</h2>
                        <p>지금 신규회원이 되면 특별 할인 혜택을 드려요.</p>
                    </div>
				</div>
			</div>
			<div class="pages">
				<span class="pgNum"></span>
				<a class="prev"><img src="./images/main/slider_prev.png"/></a>
				<a class="pause"><img src="./images/main/slider_pause.png"/></a>
				<a class="next"><img src="./images/main/slider_next.png"/></a>
			</div>
		</div>
    </section>

</body>

</html>